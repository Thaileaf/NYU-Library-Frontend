{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/extends\";\nimport React, { useCallback, useEffect, useMemo, useRef } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport min from 'lodash/min';\nimport map from 'lodash/map';\nimport constants from \"../commons/constants\";\nimport styleConstructor, { HOURS_SIDEBAR_WIDTH } from \"./style\";\nimport { populateEvents, HOUR_BLOCK_HEIGHT } from \"./Packer\";\nimport { calcTimeOffset } from \"./helpers/presenter\";\nimport TimelineHours from \"./TimelineHours\";\nimport EventBlock from \"./EventBlock\";\nimport NowIndicator from \"./NowIndicator\";\nimport useTimelineOffset from \"./useTimelineOffset\";\n\nvar Timeline = function Timeline(props) {\n  var _props$format24h = props.format24h,\n      format24h = _props$format24h === void 0 ? true : _props$format24h,\n      _props$start = props.start,\n      start = _props$start === void 0 ? 0 : _props$start,\n      _props$end = props.end,\n      end = _props$end === void 0 ? 24 : _props$end,\n      date = props.date,\n      _props$events = props.events,\n      events = _props$events === void 0 ? [] : _props$events,\n      onEventPress = props.onEventPress,\n      onBackgroundLongPress = props.onBackgroundLongPress,\n      onBackgroundLongPressOut = props.onBackgroundLongPressOut,\n      renderEvent = props.renderEvent,\n      theme = props.theme,\n      scrollToFirst = props.scrollToFirst,\n      scrollToNow = props.scrollToNow,\n      initialTime = props.initialTime,\n      showNowIndicator = props.showNowIndicator,\n      scrollOffset = props.scrollOffset,\n      onChangeOffset = props.onChangeOffset,\n      overlapEventsSpacing = props.overlapEventsSpacing,\n      rightEdgeSpacing = props.rightEdgeSpacing,\n      unavailableHours = props.unavailableHours,\n      unavailableHoursColor = props.unavailableHoursColor,\n      eventTapped = props.eventTapped;\n  var scrollView = useRef();\n  var calendarHeight = useRef((end - start) * HOUR_BLOCK_HEIGHT);\n  var styles = useRef(styleConstructor(theme || props.styles, calendarHeight.current));\n\n  var _useTimelineOffset = useTimelineOffset({\n    onChangeOffset: onChangeOffset,\n    scrollOffset: scrollOffset,\n    scrollViewRef: scrollView\n  }),\n      scrollEvents = _useTimelineOffset.scrollEvents;\n\n  var packedEvents = useMemo(function () {\n    var width = constants.screenWidth - HOURS_SIDEBAR_WIDTH;\n    return populateEvents(events, {\n      screenWidth: width,\n      dayStart: start,\n      overlapEventsSpacing: overlapEventsSpacing,\n      rightEdgeSpacing: rightEdgeSpacing\n    });\n  }, [events, start]);\n  useEffect(function () {\n    var initialPosition = 0;\n\n    if (scrollToNow) {\n      initialPosition = calcTimeOffset(HOUR_BLOCK_HEIGHT);\n    } else if (scrollToFirst && packedEvents.length > 0) {\n      var _min;\n\n      initialPosition = (_min = min(map(packedEvents, 'top'))) != null ? _min : 0;\n    } else if (initialTime) {\n      initialPosition = calcTimeOffset(HOUR_BLOCK_HEIGHT, initialTime.hour, initialTime.minutes);\n    }\n\n    if (initialPosition) {\n      setTimeout(function () {\n        var _scrollView$current;\n\n        scrollView == null ? void 0 : (_scrollView$current = scrollView.current) == null ? void 0 : _scrollView$current.scrollTo({\n          y: Math.max(0, initialPosition - HOUR_BLOCK_HEIGHT),\n          animated: true\n        });\n      }, 0);\n    }\n  }, []);\n\n  var _onEventPress = useCallback(function (eventIndex) {\n    var event = packedEvents[eventIndex];\n\n    if (eventTapped) {\n      eventTapped(event);\n    } else {\n      onEventPress == null ? void 0 : onEventPress(event);\n    }\n  }, [packedEvents, onEventPress, eventTapped]);\n\n  var renderEvents = function renderEvents() {\n    var events = packedEvents.map(function (event, i) {\n      return React.createElement(EventBlock, {\n        key: i,\n        index: i,\n        event: event,\n        styles: styles.current,\n        format24h: format24h,\n        onPress: _onEventPress,\n        renderEvent: renderEvent\n      });\n    });\n    return React.createElement(View, null, React.createElement(View, {\n      style: {\n        marginLeft: HOURS_SIDEBAR_WIDTH\n      }\n    }, events));\n  };\n\n  return React.createElement(ScrollView, _extends({\n    ref: scrollView,\n    contentContainerStyle: [styles.current.contentStyle, {\n      width: constants.screenWidth\n    }]\n  }, scrollEvents), React.createElement(TimelineHours, {\n    start: start,\n    end: end,\n    date: date,\n    format24h: format24h,\n    styles: styles.current,\n    unavailableHours: unavailableHours,\n    unavailableHoursColor: unavailableHoursColor,\n    onBackgroundLongPress: onBackgroundLongPress,\n    onBackgroundLongPressOut: onBackgroundLongPressOut\n  }), renderEvents(), showNowIndicator && React.createElement(NowIndicator, {\n    styles: styles.current\n  }));\n};\n\nexport default React.memo(Timeline);","map":{"version":3,"sources":["/Users/hannahzhao/WebstormProjects/NYU-Library-Frontend/node_modules/react-native-calendars/src/timeline/Timeline.js"],"names":["React","useCallback","useEffect","useMemo","useRef","min","map","constants","styleConstructor","HOURS_SIDEBAR_WIDTH","populateEvents","HOUR_BLOCK_HEIGHT","calcTimeOffset","TimelineHours","EventBlock","NowIndicator","useTimelineOffset","Timeline","props","format24h","start","end","date","events","onEventPress","onBackgroundLongPress","onBackgroundLongPressOut","renderEvent","theme","scrollToFirst","scrollToNow","initialTime","showNowIndicator","scrollOffset","onChangeOffset","overlapEventsSpacing","rightEdgeSpacing","unavailableHours","unavailableHoursColor","eventTapped","scrollView","calendarHeight","styles","current","scrollViewRef","scrollEvents","packedEvents","width","screenWidth","dayStart","initialPosition","length","hour","minutes","setTimeout","scrollTo","y","Math","max","animated","_onEventPress","eventIndex","event","renderEvents","i","marginLeft","contentStyle","memo"],"mappings":"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","sourcesContent":["import React, { useCallback, useEffect, useMemo, useRef } from 'react';\nimport { View, ScrollView } from 'react-native';\nimport min from 'lodash/min';\nimport map from 'lodash/map';\nimport constants from '../commons/constants';\nimport styleConstructor, { HOURS_SIDEBAR_WIDTH } from './style';\nimport { populateEvents, HOUR_BLOCK_HEIGHT } from './Packer';\nimport { calcTimeOffset } from './helpers/presenter';\nimport TimelineHours from './TimelineHours';\nimport EventBlock from './EventBlock';\nimport NowIndicator from './NowIndicator';\nimport useTimelineOffset from './useTimelineOffset';\nconst Timeline = (props) => {\n    const { format24h = true, start = 0, end = 24, date, events = [], onEventPress, onBackgroundLongPress, onBackgroundLongPressOut, renderEvent, theme, scrollToFirst, scrollToNow, initialTime, showNowIndicator, scrollOffset, onChangeOffset, overlapEventsSpacing, rightEdgeSpacing, unavailableHours, unavailableHoursColor, eventTapped } = props;\n    const scrollView = useRef();\n    const calendarHeight = useRef((end - start) * HOUR_BLOCK_HEIGHT);\n    const styles = useRef(styleConstructor(theme || props.styles, calendarHeight.current));\n    const { scrollEvents } = useTimelineOffset({ onChangeOffset, scrollOffset, scrollViewRef: scrollView });\n    const packedEvents = useMemo(() => {\n        const width = constants.screenWidth - HOURS_SIDEBAR_WIDTH;\n        return populateEvents(events, { screenWidth: width, dayStart: start, overlapEventsSpacing, rightEdgeSpacing });\n    }, [events, start]);\n    useEffect(() => {\n        let initialPosition = 0;\n        if (scrollToNow) {\n            initialPosition = calcTimeOffset(HOUR_BLOCK_HEIGHT);\n        }\n        else if (scrollToFirst && packedEvents.length > 0) {\n            initialPosition = min(map(packedEvents, 'top')) ?? 0;\n        }\n        else if (initialTime) {\n            initialPosition = calcTimeOffset(HOUR_BLOCK_HEIGHT, initialTime.hour, initialTime.minutes);\n        }\n        if (initialPosition) {\n            setTimeout(() => {\n                scrollView?.current?.scrollTo({\n                    y: Math.max(0, initialPosition - HOUR_BLOCK_HEIGHT),\n                    animated: true\n                });\n            }, 0);\n        }\n    }, []);\n    const _onEventPress = useCallback((eventIndex) => {\n        const event = packedEvents[eventIndex];\n        if (eventTapped) {\n            //TODO: remove after deprecation\n            eventTapped(event);\n        }\n        else {\n            onEventPress?.(event);\n        }\n    }, [packedEvents, onEventPress, eventTapped]);\n    const renderEvents = () => {\n        const events = packedEvents.map((event, i) => {\n            return (<EventBlock key={i} index={i} event={event} styles={styles.current} format24h={format24h} onPress={_onEventPress} renderEvent={renderEvent}/>);\n        });\n        return (<View>\n        <View style={{ marginLeft: HOURS_SIDEBAR_WIDTH }}>{events}</View>\n      </View>);\n    };\n    return (<ScrollView \n    // @ts-expect-error\n    ref={scrollView} contentContainerStyle={[styles.current.contentStyle, { width: constants.screenWidth }]} {...scrollEvents}>\n      <TimelineHours start={start} end={end} date={date} format24h={format24h} styles={styles.current} unavailableHours={unavailableHours} unavailableHoursColor={unavailableHoursColor} onBackgroundLongPress={onBackgroundLongPress} onBackgroundLongPressOut={onBackgroundLongPressOut}/>\n      {renderEvents()}\n      {showNowIndicator && <NowIndicator styles={styles.current}/>}\n    </ScrollView>);\n};\nexport default React.memo(Timeline);\n"]},"metadata":{},"sourceType":"module"}